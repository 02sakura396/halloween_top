* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: #0a0a12;
  color: #fff;
  font-family: 'M PLUS Rounded 1c', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
}
.no-select { -webkit-user-select: none; user-select: none; }

#game { position: relative; height: 100dvh; overflow: hidden; }

/* ヘッダー画像 */
#site-header { position: absolute; left: 50%; top: 24%; transform: translateX(-50%); z-index: 2; display: flex; justify-content: center; }
#site-header img { display: block; width: clamp(360px, 85vw, 800px); height: auto; margin: 6px auto; border-radius: 8px; box-shadow: 0 6px 24px rgba(0,0,0,.35); }

/* 背景 */
#bg { position: absolute; inset: 0; overflow: hidden; pointer-events: none; z-index: 0; }
#bg .stars { position: absolute; inset: 0; background:
  radial-gradient(2px 2px at 10% 20%, #fff8, #0000),
  radial-gradient(1px 1px at 30% 80%, #fff8, #0000),
  radial-gradient(1px 1px at 60% 10%, #fff8, #0000),
  radial-gradient(2px 2px at 80% 50%, #fff8, #0000);
  animation: twinkle 3s infinite linear;
}
#bg .moon { position: absolute; width: 80px; height: 80px; border-radius: 50%; background: radial-gradient(#ffd 30%, #fc0 60%, #0000 61%); top: 30px; right: 30px; box-shadow: 0 0 30px #fc0; }
#bg .pumpkins { position: absolute; bottom: 16px; width: 100%; text-align: center; opacity: .6; font-size: 20px; }
@keyframes twinkle { 0%{opacity:.8} 50%{opacity:.4} 100%{opacity:.8} }

/* シーン */
#scene { position: relative; height: 100%; display: grid; grid-template-rows: 1fr auto auto; align-items: end; padding: 16px; z-index: 1; }

#hud { position: absolute; top: 12px; left: 12px; right: 12px; display: flex; justify-content: space-between; gap: 8px; font-weight: 700; text-shadow: 0 2px 8px #000; }

/* 中央の問題ボックス */
#question-box { position: absolute; top: 38%; left: 50%; transform: translate(-50%, -50%); width: min(92vw, 720px); background: #120e1dcc; border: 2px solid #ffffff22; border-radius: 16px; padding: 16px; box-shadow: 0 12px 40px rgba(0,0,0,.35); text-align: center; z-index: 2; }
#question-number { font-size: 20px; font-weight: 700; color: #ff9bd0; margin-bottom: 8px; }
#question { font-size: 18px; line-height: 1.6; margin: 0; }

#speech { position: absolute; left: 50%; top: calc(58% + 80px); transform: translate(-50%, -50%) translateY(8px); background: #0008; border: 2px solid #fff3; border-radius: 8px; padding: 8px 12px; font-size: 16px; opacity: 0; transition: .3s ease; pointer-events: none; z-index: 2; white-space: nowrap; text-align: center; }
#speech.show { opacity: 1; transform: translate(-50%, -50%) translateY(0); }

/* 分かれ道 */
#fork { position: absolute; left: 50%; top: 58%; transform: translate(-50%, -50%); width: min(92vw, 820px); display: grid; grid-template-columns: 1fr 1fr; gap: 12px; z-index: 2; }
.choice { appearance: none; border: 0; background: linear-gradient(135deg, #6b3fa0, #3a285f); color: #fff; padding: 14px; border-radius: 12px; font-size: 16px; box-shadow: 0 6px 0 #140f23; transition: transform .05s ease, box-shadow .05s ease, background .2s; touch-action: manipulation; pointer-events: auto; display: block; cursor: pointer; font-family: inherit; }
.choice:active { transform: translateY(4px); box-shadow: 0 2px 0 #140f23; }
.choice:disabled { opacity: .6; filter: grayscale(.2); cursor: not-allowed; }

/* さくらちゃん（ドット風） */
#sakura { position: absolute; left: 70%; bottom: 36px; width: 220px; height: auto; transform: translateX(-80%); transform-origin: 50% 100%; pointer-events: none; z-index: 1; }
#sakura-img { display: block; width: 100%; height: auto; filter: drop-shadow(0 6px 10px rgba(0,0,0,.6)); transform-origin: 50% 50%; }
@keyframes sway { 0%,100%{transform: rotate(0deg)} 50%{transform: rotate(1deg)} }

.walk { animation: bob 0.5s infinite ease-in-out; }
@keyframes bob { 0%,100%{ transform: translateY(0)} 50%{ transform: translateY(-1px)} }

/* 魔法の光 */
#sparkle { position: absolute; width: 14px; height: 14px; border-radius: 50%; pointer-events: none; opacity: 0; background: radial-gradient(#fff, #9cf, #0000 70%); box-shadow: 0 0 12px 4px #9cf; mix-blend-mode: screen; }
#sparkle.show { animation: sparkle-move .5s ease-out forwards; }
@keyframes sparkle-move { 0%{opacity:1; transform: scale(.8)} 100%{opacity:0; transform: translate(var(--dx,0), var(--dy,0)) scale(1.2)} }

/* リザルト */
#overlay { position: absolute; inset: 0; background: rgba(0,0,0,.6); display: grid; place-items: center; z-index: 3; }
#overlay[hidden] { display: none !important; }
.panel { background: #201733; border: 2px solid #ffffff22; border-radius: 16px; padding: 20px; width: min(520px, 92vw); box-shadow: 0 12px 40px rgba(0,0,0,.4); text-align: center; }
.panel #result-title { font-size: 22px; font-weight: 700; margin-bottom: 8px; }
.panel #result-message { font-size: 18px; margin-bottom: 16px; word-break: keep-all; }
.primary { appearance: none; border: 0; background: linear-gradient(180deg, #ff9bd0, #ff5fa2); color: #2b2140; font-weight: 800; padding: 12px 16px; border-radius: 12px; box-shadow: 0 6px 0 #8d2d5b; }
.primary:active { transform: translateY(3px); box-shadow: 0 3px 0 #8d2d5b; }

/* スタート画面アニメーション */
#start-animation { position: fixed; inset: 0; background: rgba(0,0,0,.95); display: grid; place-items: center; z-index: 100; transition: opacity 0.3s; }
#start-animation.hidden { opacity: 0; pointer-events: none; visibility: hidden; display: none; }
#start-text { font-size: 32px; font-weight: 700; color: #fff; text-align: center; animation: fadeInOut 1s ease-in-out; }
@keyframes fadeInOut { 0%{opacity:0; transform: scale(.8)} 20%{opacity:1; transform: scale(1)} 80%{opacity:1; transform: scale(1)} 100%{opacity:0; transform: scale(1.2)} }

/* モバイル調整 */
@media (min-width: 768px){
  #site-header { top: 20%; }
  #question-box { top: 40%; }
  #question { font-size: 20px; }
  .choice { font-size: 20px; }
}

/* スマホ向け微調整 */
@media (max-width: 600px){
  #site-header { top: 18%; }
  /* PNGの可視中心を補正（やや左寄せで視覚中央に） */
  #sakura { left: 50%; transform: translateX(-56%); }
}


